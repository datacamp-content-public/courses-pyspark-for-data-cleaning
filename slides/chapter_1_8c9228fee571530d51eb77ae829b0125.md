---
title: Insert title here
key: 8c9228fee571530d51eb77ae829b0125

---
## Identify Outliers in PySpark

```yaml
type: "TitleSlide"
key: "be0107f3da"
```

`@lower_third`

name: Aiden Vincent Johnson
title: Data Scientist | Innovator | Mentor


`@script`
Welcome to this course on Identifying Outliers in Pyspark. Identifying Outliers is a necessary step in any data science project. In this course, you'll learn how to apply a common method to identify outliers in your data using PySpark.


---
## What are Outliers?

```yaml
type: "FullSlide"
key: "662fd7ac14"
```

`@part1`
- Outliers are extreme values that fall far outside the mean and standard deviation of a set of observations.
- Outliers can mislead the training process in building machine learning models.
- Outliers may be real anomalies in the observations or artificial errors.
![](https://assets.datacamp.com/production/repositories/4360/datasets/4de2e3ca5ffa48ca1b2f931e7867ca462701dd76/outputpoly-1.png)


`@script`



---
## Identify Outliers based on Extreme Value Analysis

```yaml
type: "TwoColumns"
key: "e86037980b"
```

`@part1`
- Assumes a normal distribution
- Expected values fall within 1.5 times 1st & 3rd quartile
- Find observations outside the 1.5 * IQR
- Flag outliers for removal
- Review outliers
- Delete outliers from data


`@part2`
![](https://assets.datacamp.com/production/repositories/4360/datasets/09a5b441a0d3158dc1cbe8cfb35f1dc67b480a32/Screen%20Shot%202019-01-01%20at%207.50.41%20PM.png)


`@script`



---
## Review Outliers

```yaml
type: "FullCodeSlide"
key: "090eef0d93"
```

`@part1`
`with_outliers_flag = imputed.join(outliers, on='Id')

(
    with_outliers_flag
    .filter('FuelEconomy_o')
    .select('Id', 'Manufacturer', 'Model', 'FuelEconomy')
    .show()
)`


`@script`



---
## Filter data with outliers flags

```yaml
type: "FullCodeSlide"
key: "46e2d5d9fa"
```

`@part1`
no_outliers = (
    with_outliers_flag
    .filter('!FuelEconomy_o')
    .select(imputed.columns)
)


`@script`



---
## Define IQR

```yaml
type: "FullCodeSlide"
key: "60b64d9e31"
```

`@part1`
`features = ['Displacement', 'Cylinders', 'FuelEconomy']
quantiles = [0.25, 0.75]

cut_off_points = []

for feature in features:
    quants = imputed.approxQuantile(feature, quantiles, 0.05)

    IQR = quants[1] - quants[0]
    cut_off_points.append((feature, [
        quants[0] - 1.5 * IQR,
        quants[1] + 1.5 * IQR,
    ]))

cut_off_points = dict(cut_off_points)`


`@script`



---
## Flag points outside IQR

```yaml
type: "FullCodeSlide"
key: "45e2b238aa"
```

`@part1`
`outliers = imputed.select(*['id'] + [
       (
           (imputed[f] < cut_off_points[f][0]) |
           (imputed[f] > cut_off_points[f][1])
       ).alias(f + '_o') for f in features
  ])`


`@script`



---
## Final Slide

```yaml
type: "FinalSlide"
key: "651eaf9d46"
```

`@script`


